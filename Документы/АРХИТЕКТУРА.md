# üèóÔ∏è –ê–†–•–ò–¢–ï–ö–¢–£–†–ê: FantaProjekt

**–î–∞—Ç–∞**: 24 –æ–∫—Ç—è–±—Ä—è 2025
**–í–µ—Ä—Å–∏—è**: 2.2.0
**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ**: –†–µ–æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è workspace + –µ–¥–∏–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π

---

## üéØ –ü–†–ò–ù–¶–ò–ü–´ –†–ê–ó–†–ê–ë–û–¢–ö–ò

### 1. **–ù–µ–ø—Ä–∏–∫–æ—Å–Ω–æ–≤–µ–Ω–Ω–æ—Å—Ç—å –æ—Ä–∏–≥–∏–Ω–∞–ª–∞**
- –û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ short-video-maker –ù–ï –ú–ï–ù–Ø–ï–¢–°–Ø
- –í—Å–µ –Ω–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ —á–µ—Ä–µ–∑ –†–ê–°–®–ò–†–ï–ù–ò–Ø
- 100% –æ–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

### 2. **–ú–æ–¥—É–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞**
- –ö–∞–∂–¥–∞—è –Ω–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è = –æ—Ç–¥–µ–ª—å–Ω—ã–π –º–æ–¥—É–ª—å
- –ù–µ–∑–∞–≤–∏—Å–∏–º—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
- –õ–µ–≥–∫–æ –¥–æ–±–∞–≤–ª—è—Ç—å/—É–¥–∞–ª—è—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏

### 3. **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å**
- –õ–µ–≥–∫–æ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
- –õ–µ–≥–∫–æ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã
- –õ–µ–≥–∫–æ —Ä–∞—Å—à–∏—Ä—è—Ç—å —Ñ–æ—Ä–º–∞—Ç—ã

---

## üì¶ –°–¢–†–£–ö–¢–£–†–ê –ü–†–û–ï–ö–¢–ê

```
FantaProjekt/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ core/                    # –û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ (–ù–ï –¢–†–û–ì–ê–¢–¨!)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ShortCreator.ts     # –ì–ª–∞–≤–Ω—ã–π –∫–ª–∞—Å—Å
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Pexels.ts           # Pexels API
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Kokoro.ts           # TTS –æ–∑–≤—É—á–∫–∞
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Whisper.ts          # –°—É–±—Ç–∏—Ç—Ä—ã
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ Remotion.ts         # –†–µ–Ω–¥–µ—Ä–∏–Ω–≥
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ extensions/              # –ù–û–í–´–ï —Ñ—É–Ω–∫—Ü–∏–∏ (–¥–æ–±–∞–≤–ª—è–µ–º –∑–¥–µ—Å—å)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ sources/            # –ò—Å—Ç–æ—á–Ω–∏–∫–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ SourceFactory.ts
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ URLSource.ts
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ FileSource.ts
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ PexelsSource.ts (–∞–¥–∞–ø—Ç–µ—Ä)
‚îÇ   ‚îÇ   ‚îÇ
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ effects/            # –°–∏—Å—Ç–µ–º–∞ —ç—Ñ—Ñ–µ–∫—Ç–æ–≤
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ EffectManager.ts
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ OverlayEffect.ts
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ BlendModes.ts
‚îÇ   ‚îÇ   ‚îÇ
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ overlays/           # –¢–µ–∫—Å—Ç–æ–≤—ã–µ –æ–≤–µ—Ä–ª–µ–∏
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ TextOverlay.ts
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ AnimatedText.ts
‚îÇ   ‚îÇ   ‚îÇ
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ pipeline/           # –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π –ø–∞–π–ø–ª–∞–π–Ω
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ EnhancedPipeline.ts
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ ContentProcessor.ts
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ types/                   # –¢–∏–ø—ã TypeScript
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ core.ts             # –û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–µ —Ç–∏–ø—ã
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ extensions.ts       # –ù–æ–≤—ã–µ —Ç–∏–ø—ã
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ server/                  # API —Å–µ—Ä–≤–µ—Ä—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ mcp-server.ts       # MCP –ø—Ä–æ—Ç–æ–∫–æ–ª
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ rest-server.ts      # REST API
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ components/              # Remotion –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ PortraitVideo.tsx
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ LandscapeVideo.tsx
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ EffectLayer.tsx     # –ù–û–í–´–ô
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ remotion/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ compositions/
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ SimpleOverlay.tsx       # Production overlay (onVideoFrame API)
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ BlendOverlay.tsx        # Deprecated stub
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ config/                  # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞
‚îÇ   ‚îÇ
‚îÇ   ‚îî‚îÄ‚îÄ index.ts                 # –ì–ª–∞–≤–Ω—ã–π entry point
‚îÇ
‚îú‚îÄ‚îÄ static/                      # –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã
‚îÇ   ‚îú‚îÄ‚îÄ music/                  # –§–æ–Ω–æ–≤–∞—è –º—É–∑—ã–∫–∞
‚îÇ   ‚îî‚îÄ‚îÄ effects/                # –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ —ç—Ñ—Ñ–µ–∫—Ç–æ–≤
‚îÇ       ‚îú‚îÄ‚îÄ vhs-glitch.mp4
‚îÇ       ‚îú‚îÄ‚îÄ light-leak.mp4
‚îÇ       ‚îî‚îÄ‚îÄ falling-snow.mp4
‚îÇ
‚îú‚îÄ‚îÄ workspace/                   # üÜï –†–ê–ë–û–ß–ê–Ø –ü–ê–ü–ö–ê (v2.2.0)
‚îÇ   ‚îú‚îÄ‚îÄ temp/                   # –í—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
‚îÇ   ‚îú‚îÄ‚îÄ renders/                # –ì–æ—Ç–æ–≤—ã–µ –≤–∏–¥–µ–æ
‚îÇ   ‚îú‚îÄ‚îÄ cache/                  # –ö—ç—à (TTS, Pexels, —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥)
‚îÇ   ‚îî‚îÄ‚îÄ downloads/              # –°–∫–∞—á–∞–Ω–Ω—ã–µ –º–µ–¥–∏–∞
‚îÇ
‚îú‚îÄ‚îÄ fantaprojekt-libs/           # üÜï –ë–ò–ë–õ–ò–û–¢–ï–ö–ò (v2.2.0)
‚îÇ   ‚îî‚îÄ‚îÄ libs/
‚îÇ       ‚îî‚îÄ‚îÄ whisper/            # Whisper C++ (1.6GB)
‚îÇ
‚îú‚îÄ‚îÄ –î–æ–∫—É–º–µ–Ω—Ç—ã/                   # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ –ú–ê–ù–ò–§–ï–°–¢_–ü–†–û–ï–ö–¢–ê.md
‚îÇ   ‚îú‚îÄ‚îÄ –ê–†–•–ò–¢–ï–ö–¢–£–†–ê.md (—ç—Ç–æ—Ç —Ñ–∞–π–ª)
‚îÇ   ‚îú‚îÄ‚îÄ API_–î–û–ö–£–ú–ï–ù–¢–ê–¶–ò–Ø.md
‚îÇ   ‚îî‚îÄ‚îÄ –ñ—É—Ä–Ω–∞–ª/                 # –û—Ç—á–µ—Ç—ã —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
‚îÇ
‚îú‚îÄ‚îÄ package.json
‚îú‚îÄ‚îÄ tsconfig.json
‚îú‚îÄ‚îÄ .env.example
‚îî‚îÄ‚îÄ README.md
```

---

## üîÑ –ü–û–¢–û–ö –î–ê–ù–ù–´–•

### –ë–∞–∑–æ–≤—ã–π –ø–æ—Ç–æ–∫ (–æ—Ä–∏–≥–∏–Ω–∞–ª):
```
JSON Input
  ‚Üì
ShortCreator.create()
  ‚Üì
N8n to Fanta/ Pexels.search() ‚Üí –Ω–∞–π—Ç–∏ –≤–∏–¥–µ–æ (–∏–ª–∏ –∂–µ —Å–≤–æ–∏ —Ñ–æ—Ç–æ - –≤–∏–¥–µ–æ –º–∞—Ç–µ—Ä–∏–∞–ª—ã)
  ‚Üì
Kokoro.synthesize() ‚Üí –æ–∑–≤—É—á–∫–∞
  ‚Üì
Whisper.transcribe() ‚Üí —Å—É–±—Ç–∏—Ç—Ä—ã
  ‚Üì
Remotion.render() ‚Üí —Ñ–∏–Ω–∞–ª—å–Ω–æ–µ –≤–∏–¥–µ–æ
  ‚Üì
MP4 Output
```

### –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π –ø–æ—Ç–æ–∫ (–Ω–æ–≤—ã–π):
```
JSON Input
  ‚Üì
ShortCreator.create()
  ‚Üì
SourceFactory.getSource() ‚Üí –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∏—Å—Ç–æ—á–Ω–∏–∫
  ‚îú‚îÄ PexelsSource (–µ—Å–ª–∏ searchTerms)
  ‚îú‚îÄ URLSource (–µ—Å–ª–∏ media.type = url)
  ‚îî‚îÄ FileSource (–µ—Å–ª–∏ media.type = file)
  ‚Üì
MediaDuration.calculate() ‚Üí –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –º–µ–¥–∏–∞ (–ù–û–í–û–ï v2.0)
  ‚Üì
ContentProcessor.process() ‚Üí –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å –∫–æ–Ω—Ç–µ–Ω—Ç
  ‚Üì
MediaLooper.apply() ‚Üí –∑–∞—Ü–∏–∫–ª–∏—Ç—å –µ—Å–ª–∏ < –∞—É–¥–∏–æ (–ù–û–í–û–ï v2.0)
  ‚Üì
AudioTrimmer.trim() ‚Üí –æ–±—Ä–µ–∑–∞—Ç—å –¥–æ –∞—É–¥–∏–æ (–ù–û–í–û–ï v2.0)
  ‚Üì
EffectManager.apply() ‚Üí –ø—Ä–∏–º–µ–Ω–∏—Ç—å —ç—Ñ—Ñ–µ–∫—Ç—ã (–µ—Å–ª–∏ –µ—Å—Ç—å)
  ‚Üì
TextOverlay.render() ‚Üí –¥–æ–±–∞–≤–∏—Ç—å —Ç–µ–∫—Å—Ç (–µ—Å–ª–∏ –µ—Å—Ç—å)
  ‚Üì
Kokoro.synthesize() ‚Üí –æ–∑–≤—É—á–∫–∞
  ‚Üì
Whisper.transcribe() ‚Üí —Å—É–±—Ç–∏—Ç—Ä—ã
  ‚Üì
EnhancedPipeline.render() ‚Üí —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥ —Å —ç—Ñ—Ñ–µ–∫—Ç–∞–º–∏
  ‚Üì
MP4 Output
```

---

## üß© –ö–õ–Æ–ß–ï–í–´–ï –ö–û–ú–ü–û–ù–ï–ù–¢–´

### 0. Overlay-–º–æ–¥—É–ª—å (Production —Å–∏—Å—Ç–µ–º–∞ - v1.3.6)
**–û–ë–ù–û–í–õ–ï–ù–ò–ï 18.10.2025**: –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —É–ø—Ä–æ—â–µ–Ω–∞! –û—Å—Ç–∞–ª—Å—è —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω production overlay –∫–æ–º–ø–æ–Ω–µ–Ω—Ç.

**SimpleOverlay** (`SimpleOverlay.tsx`) - –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–∞—è production —Å–∏—Å—Ç–µ–º–∞:
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π Remotion `onVideoFrame` API
- HTML5 Canvas API —Å `globalCompositeOperation` –¥–ª—è blend modes
- `<Loop>` –∫–æ–º–ø–æ–Ω–µ–Ω—Ç Remotion –¥–ª—è –∑–∞—Ü–∏–∫–ª–∏–≤–∞–Ω–∏—è overlay –≤–∏–¥–µ–æ
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ 20+ blend modes: screen, overlay, multiply, lighten, darken, color-dodge, –∏ —Ç.–¥.
- –ò—Å—Ç–æ—á–Ω–∏–∫ —ç—Ñ—Ñ–µ–∫—Ç–æ–≤: `static/effects/*` —á–µ—Ä–µ–∑ `staticFile(staticEffectPath)`
- –°—Ç–∞–±–∏–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞, –Ω–∏–∫–∞–∫–∏—Ö –ø—Ä–æ–±–ª–µ–º —Å webpack
- –ü—Ä–æ—Å—Ç–∞—è, –ø–æ–Ω—è—Ç–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

**–£—Å—Ç–∞—Ä–µ–≤—à–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã** (—É–¥–∞–ª–µ–Ω—ã/–∑–∞–≥–ª—É—à–µ–Ω—ã):
- `BlendOverlay.tsx` - CSS overlay (–∑–∞–≥–ª—É—à–µ–Ω –∫–∞–∫ deprecated stub, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç null)
- `CanvasBlendOverlay.tsx` - Canvas API –º–æ–¥—É–ª—å (–ø–æ–ª–Ω–æ—Å—Ç—å—é —É–¥–∞–ª—ë–Ω –≤ v1.3.6)
- `config/canvas-overlay.ts` - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Canvas (—É–¥–∞–ª—ë–Ω)
- `CanvasOverlayBrowser.ts` - –±—Ä–∞—É–∑–µ—Ä–Ω—ã–π —Å–ª–æ–π (—É–¥–∞–ª—ë–Ω)
- `/src/utils/canvas/` - Canvas —É—Ç–∏–ª–∏—Ç—ã (–¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è —É–¥–∞–ª–µ–Ω–∞)

**–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏ –æ—á–∏—Å—Ç–∫–∏**: –°–º. [CLEANUP_JOURNAL_2025-10-18.md](../CLEANUP_JOURNAL_2025-10-18.md)

### 1. SourceFactory (–§–∞–±—Ä–∏–∫–∞ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤)
**–ó–∞–¥–∞—á–∞**: –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∏ –ø–æ–ª—É—á–∏—Ç—å –∫–æ–Ω—Ç–µ–Ω—Ç –∏–∑ –ª—é–±–æ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞

```typescript
interface ContentSource {
  type: 'pexels' | 'url' | 'file';
  fetch(): Promise<MediaContent>;
}

class SourceFactory {
  static create(input: SceneInput): ContentSource {
    if (input.searchTerms) return new PexelsSource(input);
    if (input.media?.type === 'url') return new URLSource(input);
    if (input.media?.type === 'file') return new FileSource(input);
    throw new Error('Unknown source type');
  }
}
```

### 2. EffectManager (–ú–µ–Ω–µ–¥–∂–µ—Ä —ç—Ñ—Ñ–µ–∫—Ç–æ–≤)
**–ó–∞–¥–∞—á–∞**: –ü—Ä–∏–º–µ–Ω–∏—Ç—å —ç—Ñ—Ñ–µ–∫—Ç—ã –Ω–∞–ª–æ–∂–µ–Ω–∏—è —Å blend modes

```typescript
interface OverlayEffect {
  source: string;        // –ø—É—Ç—å –∫ —ç—Ñ—Ñ–µ–∫—Ç—É
  blendMode: BlendMode;  // —Ä–µ–∂–∏–º –Ω–∞–ª–æ–∂–µ–Ω–∏—è
  opacity: number;       // –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å
  loop?: boolean;        // –∑–∞—Ü–∏–∫–ª–∏–≤–∞—Ç—å?
}

class EffectManager {
  apply(base: VideoLayer, effects: OverlayEffect[]): CompositeLayer {
    return effects.reduce((result, effect) => {
      return this.blendLayers(result, effect);
    }, base);
  }
}
```

### 3. TextOverlay (–¢–µ–∫—Å—Ç–æ–≤—ã–µ –æ–≤–µ—Ä–ª–µ–∏) - –û–ë–ù–û–í–õ–ï–ù–û v2.1.0
**–ó–∞–¥–∞—á–∞**: –î–æ–±–∞–≤–∏—Ç—å —Å—Ç–∞—Ç–∏—á–Ω—ã–π –∏–ª–∏ –∞–Ω–∏–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç —Å –≥–∏–±–∫–∏–º –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ–º

**–ù–æ–≤–æ–µ –≤ v2.1.0**:
- üÜï 3 —Å–ø–æ—Å–æ–±–∞ –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è (–∞–ª–∏–∞—Å—ã, –ø—Ä–æ—Ü–µ–Ω—Ç—ã, –ø–∏–∫—Å–µ–ª–∏)
- üÜï –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Å–º–µ—à–∏–≤–∞–Ω–∏—è —Å–ø–æ—Å–æ–±–æ–≤
- üÜï 6 —Ç–∏–ø–æ–≤ –∞–Ω–∏–º–∞—Ü–∏–π (fadeIn, slideIn, bounce, pulse, typewriter, none)
- üÜï –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ —Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –ø—Ä–æ—Ü–µ–Ω—Ç–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π

```typescript
interface TextOverlayConfig {
  text: string;
  position: {
    x: 'left' | 'center' | 'right' | number | '50%';  // –ù–û–í–û–ï: –ø—Ä–æ—Ü–µ–Ω—Ç—ã –∏ –ø–∏–∫—Å–µ–ª–∏
    y: 'top' | 'center' | 'bottom' | number | '85%';  // –ù–û–í–û–ï: –ø—Ä–æ—Ü–µ–Ω—Ç—ã –∏ –ø–∏–∫—Å–µ–ª–∏
  };
  style: TextStyle;
  animation?: 'fadeIn' | 'slideIn' | 'bounce' | 'pulse' | 'typewriter' | 'none';  // –ù–û–í–û–ï: –±–æ–ª—å—à–µ –∞–Ω–∏–º–∞—Ü–∏–π
  timing?: { start: number; end: number };  // –ù–û–í–û–ï: —Ç–æ—á–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –≤—Ä–µ–º–µ–Ω–∏
}

class TextOverlay {
  render(config: TextOverlayConfig): RemotionComponent {
    const resolvedPosition = this.resolvePosition(config.position);  // –ù–û–í–û–ï: —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π —Ä–µ–∑–æ–ª–≤–µ—Ä
    return (
      <AbsoluteFill style={this.getPositionStyle(resolvedPosition)}>
        <Text style={config.style} animation={config.animation}>
          {config.text}
        </Text>
      </AbsoluteFill>
    );
  }

  // –ù–û–í–û–ï: –ø–æ–¥–¥–µ—Ä–∂–∫–∞ 3 —Å–ø–æ—Å–æ–±–æ–≤ –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
  resolvePosition(position: Position): { x: number; y: number } {
    // Aliases: "center" ‚Üí 50%
    // Percentages: "50%" ‚Üí 540px (Portrait)
    // Pixels: 540 ‚Üí 540px
  }
}
```

**–§–∞–π–ª—ã**:
- `src/remotion/compositions/TextOverlay.tsx` - –æ—Å–Ω–æ–≤–Ω–æ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç
- `src/components/utils/position.ts` - —É—Ç–∏–ª–∏—Ç—ã –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è

### 4. MediaDuration Manager (–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é) - –ù–û–í–û–ï v2.0
**–ó–∞–¥–∞—á–∞**: –ö–æ–Ω—Ç—Ä–æ–ª—å –≤—Ä–µ–º–µ–Ω–∏ –∫–∞–∂–¥–æ–≥–æ —Ñ–æ—Ç–æ/–≤–∏–¥–µ–æ + –∑–∞—Ü–∏–∫–ª–∏–≤–∞–Ω–∏–µ + –æ–±—Ä–µ–∑–∫–∞

```typescript
interface MediaDurationConfig {
  mediaDuration?: number;  // –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∫–∞–∂–¥–æ–≥–æ –º–µ–¥–∏–∞ —ç–ª–µ–º–µ–Ω—Ç–∞ –≤ —Å–µ–∫—É–Ω–¥–∞—Ö
  audioDuration: number;   // –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –æ–∑–≤—É—á–∫–∏
}

class MediaDurationManager {
  // –†–∞—Å—Å—á–∏—Ç–∞—Ç—å –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∫–∞–∂–¥–æ–≥–æ –º–µ–¥–∏–∞
  calculate(mediaCount: number, config: MediaDurationConfig): number[] {
    if (config.mediaDuration) {
      // –ö–∞–∂–¥–æ–µ —Ñ–æ—Ç–æ/–≤–∏–¥–µ–æ = mediaDuration —Å–µ–∫—É–Ω–¥
      return Array(mediaCount).fill(config.mediaDuration);
    }
    // –†–∞—Å–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ –ø–æ –¥–ª–∏–Ω–µ –∞—É–¥–∏–æ
    return Array(mediaCount).fill(config.audioDuration / mediaCount);
  }

  // –ó–∞—Ü–∏–∫–ª–∏—Ç—å –º–µ–¥–∏–∞ –µ—Å–ª–∏ –∫–æ—Ä–æ—á–µ –∞—É–¥–∏–æ
  loop(mediaDurations: number[], audioDuration: number): number[] {
    const totalMedia = mediaDurations.reduce((a, b) => a + b, 0);
    if (totalMedia < audioDuration) {
      // –ü–æ–≤—Ç–æ—Ä–∏—Ç—å –º–µ–¥–∏–∞ –ø–æ–∫–∞ –Ω–µ –¥–æ—Å—Ç–∏–≥–Ω–µ–º –¥–ª–∏–Ω—ã –∞—É–¥–∏–æ
      return this.loopMedia(mediaDurations, audioDuration);
    }
    return mediaDurations;
  }

  // –û–±—Ä–µ–∑–∞—Ç—å –¥–æ –¥–ª–∏–Ω—ã –∞—É–¥–∏–æ
  trim(videoDuration: number, audioDuration: number): number {
    return Math.min(videoDuration, audioDuration);
  }
}
```

### 5. VoiceSpeed Manager (–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–∫–æ—Ä–æ—Å—Ç—å—é —Ä–µ—á–∏) - –ù–û–í–û–ï v2.1.0
**–ó–∞–¥–∞—á–∞**: –£—Å–∫–æ—Ä–µ–Ω–∏–µ –æ–∑–≤—É—á–∫–∏ –¥–ª—è –¥–∏–Ω–∞–º–∏—á–Ω—ã—Ö –≤–∏–¥–µ–æ

**–ù–æ–≤–æ–µ –≤ v2.1.0**:
- üÜï FFmpeg atempo filter –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å–∫–æ—Ä–æ—Å—Ç–∏ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ç–æ–Ω–∞
- üÜï –î–∏–∞–ø–∞–∑–æ–Ω 1.0-1.5x (–æ—Ç –Ω–æ—Ä–º–∞–ª—å–Ω–æ–π –¥–æ 1.5x –±—ã—Å—Ç—Ä–µ–µ)
- üÜï –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∞—É–¥–∏–æ
- üÜï Graceful fallback –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö FFmpeg

```typescript
class VoiceSpeedManager {
  async changeSpeed(audio: ArrayBuffer, speed: number): Promise<ArrayBuffer> {
    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∏–∞–ø–∞–∑–æ–Ω–∞
    if (speed < 1.0 || speed > 1.5) {
      speed = Math.max(1.0, Math.min(1.5, speed));
    }

    // –ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å –µ—Å–ª–∏ —Å–∫–æ—Ä–æ—Å—Ç—å = 1.0
    if (speed === 1.0) return audio;

    // –ü—Ä–∏–º–µ–Ω–∏—Ç—å FFmpeg atempo filter
    return new Promise((resolve, reject) => {
      ffmpeg(inputStream)
        .audioFilters(`atempo=${speed}`)
        .audioCodec('pcm_s16le')
        .on('error', (err) => {
          // Graceful fallback: –≤–µ—Ä–Ω—É—Ç—å –æ—Ä–∏–≥–∏–Ω–∞–ª –ø—Ä–∏ –æ—à–∏–±–∫–µ
          if (err.message.includes('Output stream closed')) {
            resolve(audio);
          } else {
            reject(err);
          }
        })
        .pipe()
        .on('end', () => resolve(modifiedAudio));
    });
  }

  adjustAudioLength(originalLength: number, speed: number): number {
    return originalLength / speed;  // 10 —Å–µ–∫ * 1.5x = 6.67 —Å–µ–∫
  }
}
```

**–§–∞–π–ª—ã**:
- `src/short-creator/libraries/FFmpeg.ts` - –º–µ—Ç–æ–¥ `changeAudioSpeed()`
- `src/short-creator/ShortCreator.ts` - –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –ø–æ—Å–ª–µ TTS
- `src/types/shorts.ts` - –ø–æ–ª–µ `voiceSpeed` –≤ RenderConfig

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏**:
- 1.0-1.2 - –¥–ª—è –æ–±—É—á–∞—é—â–∏—Ö –≤–∏–¥–µ–æ
- 1.2-1.3 - –¥–ª—è TikTok/Shorts (–æ–ø—Ç–∏–º–∞–ª—å–Ω–æ)
- 1.3-1.5 - –¥–ª—è –æ—á–µ–Ω—å –¥–∏–Ω–∞–º–∏—á–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞

### 6. EnhancedPipeline (–†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π –ø–∞–π–ø–ª–∞–π–Ω)
**–ó–∞–¥–∞—á–∞**: –°–æ–±—Ä–∞—Ç—å –≤—Å—ë –≤–º–µ—Å—Ç–µ —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–π –ª–æ–≥–∏–∫–∏

```typescript
class EnhancedPipeline {
  async render(input: CreateShortInput): Promise<VideoOutput> {
    // 1. –ü–æ–ª—É—á–∏—Ç—å –∫–æ–Ω—Ç–µ–Ω—Ç (–Ω–æ–≤–æ–µ –∏–ª–∏ –æ—Ä–∏–≥–∏–Ω–∞–ª)
    const content = await this.getContent(input);

    // 2. –†–∞—Å—Å—á–∏—Ç–∞—Ç—å –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –º–µ–¥–∏–∞ (–ù–û–í–û–ï v2.0)
    const durations = this.mediaDurationManager.calculate(
      content.length,
      { mediaDuration: input.mediaDuration, audioDuration: input.audioDuration }
    );

    // 3. –ü—Ä–∏–º–µ–Ω–∏—Ç—å —ç—Ñ—Ñ–µ–∫—Ç—ã (–µ—Å–ª–∏ –µ—Å—Ç—å)
    const withEffects = await this.applyEffects(content, input.effects);

    // 4. –î–æ–±–∞–≤–∏—Ç—å —Ç–µ–∫—Å—Ç (–µ—Å–ª–∏ –µ—Å—Ç—å)
    const withText = await this.addTextOverlays(withEffects, input.textOverlays);

    // 5. –û–†–ò–ì–ò–ù–ê–õ–¨–ù–ê–Ø –ª–æ–≥–∏–∫–∞: TTS + Whisper + Remotion
    return await this.originalPipeline.render(withText);
  }
}
```

---

## üé® –°–ò–°–¢–ï–ú–ê BLEND MODES

### –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞–ª–æ–∂–µ–Ω–∏–µ —ç—Ñ—Ñ–µ–∫—Ç–æ–≤:

```typescript
// –ë–∞–∑–æ–≤—ã–π —Å–ª–æ–π (–∫–æ–Ω—Ç–µ–Ω—Ç)
const baseLayer = <Video src={contentUrl} />;

// –≠—Ñ—Ñ–µ–∫—Ç VHS
const vhsLayer = (
  <Video 
    src="/effects/vhs-glitch.mp4" 
    style={{
      mixBlendMode: 'overlay',
      opacity: 0.6
    }}
  />
);

// –≠—Ñ—Ñ–µ–∫—Ç —Å–≤–µ—Ç–æ–≤—ã—Ö —É—Ç–µ—á–µ–∫
const lightLeakLayer = (
  <Video 
    src="/effects/light-leak.mp4" 
    style={{
      mixBlendMode: 'screen',
      opacity: 0.4
    }}
  />
);

// –ö–æ–º–ø–æ–∑–∏—Ü–∏—è —Å–ª–æ—ë–≤
<AbsoluteFill>
  {baseLayer}
  {vhsLayer}
  {lightLeakLayer}
</AbsoluteFill>
```

### –î–æ—Å—Ç—É–ø–Ω—ã–µ Blend Modes:
- `normal` - –æ–±—ã—á–Ω–æ–µ
- `multiply` - —É–º–Ω–æ–∂–µ–Ω–∏–µ (–∑–∞—Ç–µ–º–Ω–µ–Ω–∏–µ)
- `screen` - –æ—Å–≤–µ—Ç–ª–µ–Ω–∏–µ
- `overlay` - –ø–µ—Ä–µ–∫—Ä—ã—Ç–∏–µ (–∫–æ–Ω—Ç—Ä–∞—Å—Ç)
- `darken` - —Ç–µ–º–Ω–µ–µ
- `lighten` - —Å–≤–µ—Ç–ª–µ–µ
- `color-dodge` - –æ—Å–≤–µ—Ç–ª–µ–Ω–∏–µ —Ü–≤–µ—Ç–æ–≤
- `color-burn` - –∑–∞—Ç–µ–º–Ω–µ–Ω–∏–µ —Ü–≤–µ—Ç–æ–≤
- `hard-light` - –∂—ë—Å—Ç–∫–∏–π —Å–≤–µ—Ç
- `soft-light` - –º—è–≥–∫–∏–π —Å–≤–µ—Ç
- `difference` - —Ä–∞–∑–Ω–∏—Ü–∞
- `exclusion` - –∏—Å–∫–ª—é—á–µ–Ω–∏–µ

---

## üîå API –ò–ù–¢–ï–ì–†–ê–¶–ò–Ø

### REST API Endpoints:

#### POST /api/short-video
–°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —Ä–æ–ª–∏–∫–∞

**Request**:
```json
{
  "scenes": [...],
  "config": {...}
}
```

**Response**:
```json
{
  "videoId": "abc123",
  "status": "processing"
}
```

#### GET /api/short-video/:id/status
–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞

**Response**:
```json
{
  "status": "ready",
  "progress": 100,
  "url": "/api/short-video/abc123"
}
```

#### GET /api/short-video/:id
–°–∫–∞—á–∞—Ç—å –≥–æ—Ç–æ–≤—ã–π —Ä–æ–ª–∏–∫

**Response**: Binary (video/mp4)

---

## üß™ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï

### –Æ–Ω–∏—Ç-—Ç–µ—Å—Ç—ã:
```bash
npm test
```

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã:
```bash
npm run test:integration
```

### E2E —Ç–µ—Å—Ç—ã:
```bash
npm run test:e2e
```

---

## üöÄ ROADMAP –†–ê–ó–†–ê–ë–û–¢–ö–ò

### –§–∞–∑–∞ 1: –ë–∞–∑–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å (–°–ï–ô–ß–ê–°)
- ‚úÖ –ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π –ø—Ä–æ–µ–∫—Ç
- ‚úÖ –î–æ–±–∞–≤–∏—Ç—å SourceFactory (URL, Files)
- ‚úÖ –î–æ–±–∞–≤–∏—Ç—å EffectManager (blend modes)
- ‚úÖ –î–æ–±–∞–≤–∏—Ç—å TextOverlay
- ‚úÖ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –±–∞–∑–æ–≤—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π

### –§–∞–∑–∞ 2: –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏
- üîÑ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∞–Ω–∏–º–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ç–µ–∫—Å—Ç–æ–≤
- üîÑ –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –≥–æ—Ç–æ–≤—ã—Ö —ç—Ñ—Ñ–µ–∫—Ç–æ–≤
- üîÑ Zoom —ç—Ñ—Ñ–µ–∫—Ç—ã –¥–ª—è —Ñ–æ—Ç–æ
- üîÑ Transitions –º–µ–∂–¥—É —Å—Ü–µ–Ω–∞–º–∏

### –§–∞–∑–∞ 3: –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è
- üîÑ –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–π —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥
- üîÑ –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
- üîÑ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–∞–º—è—Ç–∏
- üîÑ GPU —É—Å–∫–æ—Ä–µ–Ω–∏–µ (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω–æ)

---

## üìã CHECKLIST –†–ê–ó–†–ê–ë–û–¢–ß–ò–ö–ê

### –ü—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –Ω–æ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–∏:

- [ ] –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –º–æ–¥—É–ª—å –≤ `/src/extensions/`
- [ ] –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –≤ `/src/types/extensions.ts`
- [ ] –ù–ï –ú–ï–ù–Ø–¢–¨ —Ñ–∞–π–ª—ã –≤ `/src/core/`
- [ ] –î–æ–±–∞–≤–∏—Ç—å –æ–±—Ä–∞—Ç–Ω—É—é —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å
- [ ] –ù–∞–ø–∏—Å–∞—Ç—å —é–Ω–∏—Ç-—Ç–µ—Å—Ç—ã
- [ ] –û–±–Ω–æ–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é
- [ ] –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü—Ä–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–∏ –±–∞–≥–æ–≤:

- [ ] –í–æ—Å–ø—Ä–æ–∏–∑–≤–µ—Å—Ç–∏ –±–∞–≥ –ª–æ–∫–∞–ª—å–Ω–æ
- [ ] –ù–∞–ø–∏—Å–∞—Ç—å failing test
- [ ] –ò—Å–ø—Ä–∞–≤–∏—Ç—å –∫–æ–¥
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ —Ç–µ—Å—Ç –ø—Ä–æ—Ö–æ–¥–∏—Ç
- [ ] –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ —Ç–µ—Å—Ç—ã
- [ ] –û–±–Ω–æ–≤–∏—Ç—å CHANGELOG.md

---

## üìÅ WORKSPACE - –ï–î–ò–ù–ê–Ø –†–ê–ë–û–ß–ê–Ø –ü–ê–ü–ö–ê (v2.2.0)

### üéØ –ö–æ–Ω—Ü–µ–ø—Ü–∏—è

**–ü—Ä–æ–±–ª–µ–º–∞:** –§–∞–π–ª—ã —Å–æ–∑–¥–∞–≤–∞–ª–∏—Å—å –≤ —Ä–∞–∑–Ω—ã—Ö –º–µ—Å—Ç–∞—Ö:
- –í—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –≤ `/root/.ai-agents-az-video-generator/temp`
- –†–µ–Ω–¥–µ—Ä—ã –≤ `/root/.ai-agents-az-video-generator/videos`
- –ö—ç—à –≤–Ω—É—Ç—Ä–∏ `videosDirPath/.cache`
- –ó–∞–≥—Ä—É–∑–∫–∏ –Ω–µ–ø–æ–Ω—è—Ç–Ω–æ –≥–¥–µ

**–†–µ—à–µ–Ω–∏–µ:** –ï–¥–∏–Ω–∞—è –ø–∞–ø–∫–∞ `workspace/` —Å–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ –ø–æ–¥–ø–∞–ø–∫–∞–º–∏.

### üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ Workspace

```
workspace/
‚îú‚îÄ‚îÄ temp/           # –í—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã (–ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–µ)
‚îú‚îÄ‚îÄ renders/        # –ì–æ—Ç–æ–≤—ã–µ –≤–∏–¥–µ–æ (—Ä–µ–∑—É–ª—å—Ç–∞—Ç —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞)
‚îú‚îÄ‚îÄ cache/          # –ö—ç—à (TTS, Pexels, —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥)
‚îî‚îÄ‚îÄ downloads/      # –°–∫–∞—á–∞–Ω–Ω—ã–µ –º–µ–¥–∏–∞ –∏–∑ –≤–Ω–µ—à–Ω–∏—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤
```

### üóÇÔ∏è –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –ø–∞–ø–æ–∫

#### `temp/` - –í—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
**–ß—Ç–æ —Ö—Ä–∞–Ω–∏—Ç—Å—è:**
- –ó–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ –º–µ–¥–∏–∞ –∏–∑ n8n (—Ñ–æ—Ç–æ, –≤–∏–¥–µ–æ)
- –ü—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–µ –∞—É–¥–∏–æ —Ñ–∞–π–ª—ã (WAV, MP3)
- –í—Ä–µ–º–µ–Ω–Ω—ã–µ –≤–∏–¥–µ–æ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏
- –§–∞–π–ª—ã –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞

**–û—á–∏—Å—Ç–∫–∞:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∫–∞–∂–¥—ã–π –¥–µ–Ω—å (—Ñ–∞–π–ª—ã —Å—Ç–∞—Ä—à–µ 1 –¥–Ω—è)

#### `renders/` - –ì–æ—Ç–æ–≤—ã–µ –≤–∏–¥–µ–æ
**–ß—Ç–æ —Ö—Ä–∞–Ω–∏—Ç—Å—è:**
- –§–∏–Ω–∞–ª—å–Ω—ã–µ –≤–∏–¥–µ–æ –ø–æ—Å–ª–µ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞ (MP4)
- –§–æ—Ä–º–∞—Ç –∏–º–µ–Ω–∏: `{videoId}.mp4`

**–û—á–∏—Å—Ç–∫–∞:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∫–∞–∂–¥—É—é –Ω–µ–¥–µ–ª—é (—Ñ–∞–π–ª—ã —Å—Ç–∞—Ä—à–µ 7 –¥–Ω–µ–π)

**API:** `GET /api/short-video/:id` ‚Üí —Å–∫–∞—á–∏–≤–∞–µ—Ç –∏–∑ —ç—Ç–æ–π –ø–∞–ø–∫–∏

#### `cache/` - –ö—ç—à
**–ß—Ç–æ —Ö—Ä–∞–Ω–∏—Ç—Å—è:**
- –ö—ç—à Pexels API (–≤–∏–¥–µ–æ, –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è)
- –ö—ç—à TTS (Kokoro) –¥–ª—è –ø–æ–≤—Ç–æ—Ä—è—é—â–∏—Ö—Å—è —Ñ—Ä–∞–∑
- –ö—ç—à —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞ (–ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–µ —Ñ–∞–π–ª—ã)

**–û—á–∏—Å—Ç–∫–∞:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ —Ä–∞–∑–º–µ—Ä—É (–º–∞–∫—Å. 5GB, —É–¥–∞–ª—è—é—Ç—Å—è —Å—Ç–∞—Ä—ã–µ —Ñ–∞–π–ª—ã)

#### `downloads/` - –ó–∞–≥—Ä—É–∑–∫–∏
**–ß—Ç–æ —Ö—Ä–∞–Ω–∏—Ç—Å—è:**
- –ú–µ–¥–∏–∞ —Ñ–∞–π–ª—ã —Å–∫–∞—á–∞–Ω–Ω—ã–µ –ø–æ URL (UrlSource)
- –§–∞–π–ª—ã –∏–∑ n8n binary data
- –í—Ä–µ–º–µ–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑ –≤–Ω–µ—à–Ω–∏—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤

**–û—á–∏—Å—Ç–∫–∞:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∫–∞–∂–¥—ã–µ 3 –¥–Ω—è

---

### ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Workspace

**–í –∫–æ–¥–µ (`src/config.ts`):**
```typescript
// Workspace directory (temp files, renders, cache, downloads)
this.workspaceDirPath =
  process.env.WORKSPACE_DIR_PATH ||
  path.join(this.packageDirPath, "workspace");

this.tempDirPath = path.join(this.workspaceDirPath, "temp");
this.videosDirPath = path.join(this.workspaceDirPath, "renders");
this.cacheDirPath = path.join(this.workspaceDirPath, "cache");
this.downloadsDirPath = path.join(this.workspaceDirPath, "downloads");
```

**–í .env:**
```env
# –ü–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ workspace (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
WORKSPACE_DIR_PATH=/custom/path/to/workspace
```

**–ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:** `./workspace` (–≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞)

---

### üóÑÔ∏è FANTAPROJEKT-LIBS - –ë–∏–±–ª–∏–æ—Ç–µ–∫–∏

**–ó–∞—á–µ–º –æ—Ç–¥–µ–ª—å–Ω–∞—è –ø–∞–ø–∫–∞?**
- –ë–∏–±–ª–∏–æ—Ç–µ–∫–∏ (whisper) –ù–ï –¥–æ–ª–∂–Ω—ã –æ—á–∏—â–∞—Ç—å—Å—è
- –ó–∞–Ω–∏–º–∞—é—Ç –º–Ω–æ–≥–æ –º–µ—Å—Ç–∞ (1.6GB)
- –†–µ–¥–∫–æ –º–µ–Ω—è—é—Ç—Å—è

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞:**
```
fantaprojekt-libs/
‚îú‚îÄ‚îÄ libs/
‚îÇ   ‚îî‚îÄ‚îÄ whisper/                # Whisper C++ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ (1.6GB)
‚îú‚îÄ‚îÄ installation-successful      # –ú–∞—Ä–∫–µ—Ä —É—Å—Ç–∞–Ω–æ–≤–∫–∏
‚îî‚îÄ‚îÄ temp/                       # –ü—É—Å—Ç–∞—è (legacy)
```

**–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:**
```typescript
// Libraries directory (whisper models, etc.)
this.dataDirPath =
  process.env.LIBS_DIR_PATH ||
  path.join(this.packageDirPath, "fantaprojekt-libs");

this.whisperInstallPath = path.join(this.dataDirPath, "libs/whisper");
```

---

### üßπ –ê–≤—Ç–æ–æ—á–∏—Å—Ç–∫–∞ Workspace

**–ù–∞—Å—Ç—Ä–æ–π–∫–∞:** `/etc/cron.daily/fantaprojekt-cleanup.sh`

```bash
#!/bin/bash
WORKSPACE=/home/developer/projects/FantaProjekt/workspace

# –í—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã —Å—Ç–∞—Ä—à–µ 1 –¥–Ω—è
find $WORKSPACE/temp -type f -mtime +1 -delete

# –ó–∞–≥—Ä—É–∑–∫–∏ —Å—Ç–∞—Ä—à–µ 3 –¥–Ω–µ–π
find $WORKSPACE/downloads -type f -mtime +3 -delete

# –†–µ–Ω–¥–µ—Ä—ã —Å—Ç–∞—Ä—à–µ 7 –¥–Ω–µ–π
find $WORKSPACE/renders -type f -mtime +7 -delete

# –ö—ç—à –µ—Å–ª–∏ > 5GB (—É–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä—ã–µ —Ñ–∞–π–ª—ã)
SIZE=$(du -sb $WORKSPACE/cache | cut -f1)
if [ $SIZE -gt 5368709120 ]; then
  find $WORKSPACE/cache -type f -printf '%T@ %p\n' | \
    sort -n | head -n -1000 | cut -d' ' -f2- | xargs rm -f
fi

# Docker cleanup
docker image prune -f
docker container prune -f
```

**–ó–∞–ø—É—Å–∫:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 03:00

---

### üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ Workspace

**–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–∑–º–µ—Ä:**
```bash
du -sh workspace/*
```

**–í—ã–≤–æ–¥:**
```
4.2M    workspace/cache
156M    workspace/downloads
1.3G    workspace/renders
89M     workspace/temp
```

**–û—á–∏—Å—Ç–∏—Ç—å –≤—Ä—É—á–Ω—É—é (–≤—Å—ë):**
```bash
rm -rf workspace/{temp,downloads,renders,cache}/*
```

**–û—á–∏—Å—Ç–∏—Ç—å —Ç–æ–ª—å–∫–æ temp:**
```bash
rm -rf workspace/temp/*
```

---

### ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

1. **–ù–ï —É–¥–∞–ª—è–π—Ç–µ —Å–∞–º–∏ –ø–∞–ø–∫–∏** (`temp`, `renders`, `cache`, `downloads`) - —Ç–æ–ª—å–∫–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ
2. **–ù–ï —Ö—Ä–∞–Ω–∏—Ç–µ –≤–∞–∂–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ** –≤ workspace - –æ–Ω–∏ –±—É–¥—É—Ç —É–¥–∞–ª–µ–Ω—ã
3. **–°–∫–∞—á–∏–≤–∞–π—Ç–µ –≤–∏–¥–µ–æ** —á–µ—Ä–µ–∑ API –¥–æ –∞–≤—Ç–æ–æ—á–∏—Å—Ç–∫–∏ (7 –¥–Ω–µ–π)
4. **Kokoro –º–æ–¥–µ–ª–∏** –≤ `node_modules/.cache/` - –ù–ï —Ç—Ä–æ–≥–∞—Ç—å!
5. **Whisper –±–∏–±–ª–∏–æ—Ç–µ–∫–∞** –≤ `fantaprojekt-libs/` - –ù–ï —Ç—Ä–æ–≥–∞—Ç—å!

---

### üîÑ –ú–∏–≥—Ä–∞—Ü–∏—è —Å–æ —Å—Ç–∞—Ä–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã

**–°—Ç–∞—Ä–æ–µ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:**
```
/root/.ai-agents-az-video-generator/
‚îú‚îÄ‚îÄ libs/whisper/          ‚Üí fantaprojekt-libs/libs/whisper/
‚îú‚îÄ‚îÄ videos/                ‚Üí workspace/renders/
‚îî‚îÄ‚îÄ temp/                  ‚Üí workspace/temp/
```

**–ú–∏–≥—Ä–∞—Ü–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∞:** 24 –æ–∫—Ç—è–±—Ä—è 2025

**–°–º. –æ—Ç—á–µ—Ç:** `/–î–æ–∫—É–º–µ–Ω—Ç—ã/–ñ—É—Ä–Ω–∞–ª/–†–ï–û–†–ì–ê–ù–ò–ó–ê–¶–ò–Ø_WORKSPACE_24OCT2025.md`

---

**FantaProjekt Development Team** ¬© 2025

