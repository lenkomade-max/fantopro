# СТАТУС ПРОЕКТА (18 Oct 2025)

## Состояние
- Основной функционал генерации видео работает.
- **ОБНОВЛЕНИЕ v1.3.6**: Архитектура overlay упрощена! Удалён Canvas API модуль, заглушен CSS Overlay.
- Подсистема оверлеев: кэш и фикс путей для Remotion (`staticFile(staticEffectPath)`), тайминги через `Sequence`, увеличен `renderTimeout`.

### Overlay-модули (актуальное состояние v1.3.6)
- **SimpleOverlay** (`SimpleOverlay.tsx`): ✅ PRODUCTION СИСТЕМА
  - Использует официальный Remotion `onVideoFrame` API
  - HTML5 Canvas API с `globalCompositeOperation` для blend modes
  - `<Loop>` компонент для зацикливания overlay видео
  - Поддержка 20+ blend modes (screen, overlay, multiply, lighten, darken и т.д.)
  - Стабильная работа, нет проблем с webpack

- **Устаревшие компоненты**:
  - `BlendOverlay.tsx` - CSS overlay (заглушен как deprecated stub)
  - `CanvasBlendOverlay.tsx` - Canvas API модуль (удалён 18.10.2025)
  - `config/canvas-overlay.ts` - конфиг Canvas API (удалён)
  - `CanvasOverlayBrowser.ts` - браузерный слой Canvas (удалён)

**Детали очистки**: См. [CLEANUP_JOURNAL_2025-10-18.md](../CLEANUP_JOURNAL_2025-10-18.md)

## Ключевые изменения

### До v1.3.6 (устаревшее)
- Новый модуль `OverlayCache` с перекодированием и хэш-путями в `static/effects`.
- Обновлён `BlendOverlay.tsx` для безопасной загрузки и тайминга.
- Обновлены `PortraitVideo.tsx`/`LandscapeVideo.tsx` для передачи `staticEffectPath`.
- Таймаут рендера увеличен до 120s.

### v1.3.6 (18 Oct 2025) - Упрощение архитектуры overlay
- ✅ Удалён Canvas API модуль полностью (7 файлов, ~600 строк кода)
- ✅ Заглушен CSS Overlay (`BlendOverlay.tsx`) как deprecated stub
- ✅ SimpleOverlay - единственная production система
- ✅ Исправлен TypeScript баг в `SimpleOverlay.tsx` (loop prop → `<Loop>` компонент)
- ✅ Очищен `EffectManager.ts` от Canvas методов (10 методов удалено)
- ✅ Обновлена вся документация (README, CLAUDE, АРХИТЕКТУРА, МАНИФЕСТ, СТАТУС)
- ✅ Проект собирается без ошибок

## Следующие шаги
- Полное тестирование SimpleOverlay с различными blend modes
- Оптимизация производительности рендеринга при множественных overlay
- Добавить unit-тесты для SimpleOverlay
- Протестировать пути: `static/effects/*` через `staticFile()`, HTTP `overlayUrl`

## Ссылки
- MANIFEST: `MANIFEST.md`
- Подробный борт: `Документы/Журнал/ЗАДАЧА_ДЛЯ_РАЗРАБОТЧИКА_ПОЛНЫЙ_КОНТЕКСТ_15OCT2025.md`
